<!doctype html>



  


<html class="theme-next mist use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="On The Way" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="Write Something when I&apos;m on the way to be a real programmer.">
<meta property="og:type" content="website">
<meta property="og:title" content="On The Way">
<meta property="og:url" content="http://delavior.net/index.html">
<meta property="og:site_name" content="On The Way">
<meta property="og:description" content="Write Something when I&apos;m on the way to be a real programmer.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="On The Way">
<meta name="twitter:description" content="Write Something when I&apos;m on the way to be a real programmer.">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 'undefined',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://delavior.net/"/>


  <title> On The Way </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans,en,default">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-64537113-2', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">On The Way</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于我
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'zydjF9KVxHP4TgbEY-TQ','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/16/线程生命周期/" itemprop="url">
                  线程生命周期
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-16T10:30:45+08:00" content="2017-10-16">
              2017-10-16
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/10/16/线程生命周期/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/10/16/线程生命周期/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>线程生命周期有新建(New)、就绪(Runnable)、运行(Running)、阻塞(Blocked)、死亡(Dead)5种状态。</p>
<ol>
<li>新建状态，当程序使用new创建了一个线程之后，该线程处于创建状态，此时仅由JVM为其分配内存，并初始化其成员变量的值。</li>
<li>就绪状态，当线程对象调用了start()方法之后，该线程处于就绪状态。Java虚拟机会为其创建方法调用栈和程序计数器，等待调度运行。</li>
<li>运行状态，如果处于就绪状态的线程获得了CPU，开始执行run()方法的线程执行体，则该线程处于运行状态。</li>
<li>阻塞状态，当处于运行状态的线程失去所占用资源之后，便进入阻塞状态。</li>
<li>死亡状态，当线程的run()方法或call()方法执行完毕，或抛出一个未获取的异常时线程进入死亡状态</li>
</ol>
<p>线程调度策略：</p>
<ul>
<li>抢占式调度策略(现代桌面和服务器操作系统)：系统会给每个可执行的线程一个小时间段来处理任务，当该时间段用完后系统就会剥夺该线程占用的资源，让其他线程获得执行的机会。在选择下一个线程时，操作系统会考虑线程的优先级。</li>
<li>协作式调度策略(小型设备)：只有当一个线程调用了sleep()或yield()方法才会放弃所占用的资源，也就是必须由线程主动放弃所占用的资源。</li>
</ul>
<p>当发生如下情况时，线程会进入阻塞状态：</p>
<ul>
<li>线程调用sleep()方法主动放弃所占用的CPU资源</li>
<li>线程调用了一个阻塞式IO方法，在该方法返回前，线程被阻塞</li>
<li>线程试图获得一个锁，但该锁正被其它线程所持有。</li>
<li>线程在等待某个通知notify。</li>
<li>程序调用了线程的suspend()方法将该线程挂起。但该方法容易导致死锁，不推荐使用。</li>
</ul>
<p>线程结束：</p>
<ul>
<li>run()或call()方法执行完成，线程正常结束。</li>
<li>线程抛出一个未捕获的Exception或Error</li>
<li>直接调用线程stop()方法来结束该线程——该方法容易导致死锁，不推荐使用</li>
</ul>
<p>当线程结束后，不能再调用start()方法使其重新启动(IllegalThreadStateException)。</p>
<p>当主线程结束后，其他线程不会随之结束。可以调用线程的isAlive()方法判断线程是否死亡，当线程处于就绪、运行、阻塞状态时该方法返回true。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/13/httpclient使用/" itemprop="url">
                  httpclient使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-13T17:36:31+08:00" content="2017-10-13">
              2017-10-13
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/10/13/httpclient使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/10/13/httpclient使用/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>以下适用于<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt;</div><div class="line">&lt;artifactId&gt;httpclient&lt;/artifactId&gt;</div><div class="line">&lt;version&gt;4.5.3&lt;/version&gt;</div></pre></td></tr></table></figure></p>
<h3 id="1-创建httpClient对象"><a href="#1-创建httpClient对象" class="headerlink" title="1. 创建httpClient对象"></a>1. 创建httpClient对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CloseableHttpClient httpClient = HttpClients.createDefault();</div></pre></td></tr></table></figure>
<p>也可以手动构建<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CloseableHttpClient httpClient = HttpClients.custom().setXXX().build();</div></pre></td></tr></table></figure></p>
<h3 id="设置连接超时"><a href="#设置连接超时" class="headerlink" title="设置连接超时"></a>设置连接超时</h3><p>连接超时的三个参数(默认三个参数为-1，即永不超时):</p>
<ul>
<li>connectionRequestTimeout:从连接池中获取连接的超时时间，超时抛出org.apache.http.conn.ConnectionPoolTimeoutException:Timeout waiting for connection from pool</li>
<li>connectTimeout:请求服务器超时时间，超时抛出connect timeout</li>
<li>socketTimeout:服务器响应超时时间，超时抛出read timeout</li>
</ul>
<p>手动设置超时时间:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">RequestConfig requestConfig = RequestConfig.custom().setConnectionRequestTimeout(5000).setConnectTimeout(5000).setSocketTimeout(5000).build();</div></pre></td></tr></table></figure></p>
<h3 id="设置重试"><a href="#设置重试" class="headerlink" title="设置重试"></a>设置重试</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">HttpRequestRetryHandler retryHandler = new DefaultHttpRequestRetryHandler(3, true);</div><div class="line">HttpClients.custom().setRetryHandler(retryHandler);</div></pre></td></tr></table></figure>
<p>第一个参数为重试次数，第二次参数是否重试</p>
<h3 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">HttpHost proxy = new HttpHost(&quot;ip&quot;, port);</div><div class="line">HttpRoutePlanner routePlanner = new DefaultProxyRoutePlanner(proxy, DefaultSchemePortResolver.INSTANCE);</div><div class="line">HttpClients.custom().setRoutePlanner(routePlanner);</div></pre></td></tr></table></figure>
<p>如果需要用户密码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">CredentialsProvider credentialsProvider = new BasicCredentialsProvider();</div><div class="line">credentialsProvider.setCredentials(new AuthScope(&quot;ip&quot;, port), new UsernamePasswordCredentials(&quot;username&quot;, &quot;password&quot;));</div><div class="line">HttpClients.custom().setDefaultCredentialsProvider(credentialsProvider);</div></pre></td></tr></table></figure></p>
<h3 id="设置cookie"><a href="#设置cookie" class="headerlink" title="设置cookie"></a>设置cookie</h3><p>cookie策略(CookieSpec)(CookiePolicy deprecated)</p>
<ul>
<li>netscape</li>
<li>standard(rfc 6265标准)</li>
<li>standard-strict(rfc 6265严格)</li>
<li>default</li>
<li>ignoreCookies</li>
<li>best-match(deprecated)</li>
<li>compatibility(deprecated)</li>
</ul>
<p>设置cookie策略<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">RequestConfig.custom().setCookieSpec(CookieSpecs.DEFAULT).build();</div></pre></td></tr></table></figure></p>
<p>使用cookieStore(无论收发都要用到，存放cookie的集合TreeSet)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">CookieStore cookieStore = new BasicCookieStore();</div><div class="line">HttpClients.custom().setDefaultCookieStore(cookieStore);</div></pre></td></tr></table></figure></p>
<p>发cookie<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">BasicClientCookie basicClientCookie = new BasicClientCookie(&quot;cookieName&quot;, &quot;cookieValue&quot;);</div><div class="line">basicClientCookie.setCreationDate(new Date());</div><div class="line">basicClientCookie.setDomain(&quot;&quot;);</div><div class="line">basicClientCookie.setExpiryDate(null);</div><div class="line">basicClientCookie.setVersion(0);</div><div class="line">basicClientCookie.setPath(&quot;&quot;);</div><div class="line">basicClientCookie.setAttribute(&quot;&quot;, &quot;&quot;);</div></pre></td></tr></table></figure></p>
<p>cookie属性理解</p>
<ul>
<li>domain:cookie所在的域名，如果未指定则为当前页面域名，只有访问的域名匹配上domain属性，cookie才会发送</li>
<li>path:cookie所在的路径，必须是绝对路径，只有path与当前向服务端发送的路径匹配，cookie才会发送(只有domain匹配了，才会进行path的匹配判断)</li>
<li>version:cookie有2个不同格式版本，cookie version 0是netscape制定的，cookie version 1是根据rfc 2109制定的，java限制使用version 0</li>
</ul>
<p>获取cookie<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">List&lt;Cookie&gt; cookies = cookieStore.getCookies();</div></pre></td></tr></table></figure></p>
<h2 id="2-构建请求-以post为例"><a href="#2-构建请求-以post为例" class="headerlink" title="2. 构建请求(以post为例)"></a>2. 构建请求(以post为例)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">HttpPost httpPost = new HttpPost(String url);</div></pre></td></tr></table></figure>
<p>添加header:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">httpPost.addHeader(Header);</div><div class="line">httpPost.addHeader(&quot;&quot;,&quot;&quot;);</div></pre></td></tr></table></figure></p>
<p>发送数据:</p>
<ul>
<li><p>可以使用StringEntity(json对象转换为字符串):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">String requestMsg = &quot;&quot;;</div><div class="line">StringEntity entity = new StringEntity(requestMsg);</div><div class="line">httpPost.setEntity(entity);</div></pre></td></tr></table></figure>
</li>
<li><p>可以使用UrlEncodedFormEntity</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">List&lt;NameValuePair&gt; nameValuePairs = new ArrayList&lt;&gt;();</div><div class="line">nameValuePairs.add(new BasicNameValuePair(&quot;&quot;, &quot;&quot;));</div><div class="line">nameValuePairs.add(new BasicNameValuePair(&quot;&quot;, &quot;&quot;));</div><div class="line">UrlEncodedFormEntity formEntity = new UrlEncodedFormEntity(nameValuePairs);</div><div class="line">httpPost.setEntity(formEntity);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="3-执行请求"><a href="#3-执行请求" class="headerlink" title="3. 执行请求"></a>3. 执行请求</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CloseableHttpResponse response = httpClient.execute(HttpUriRequest); // HttpUriRequest为httpGet/httpPost等的接口</div></pre></td></tr></table></figure>
<h2 id="4-处理结果"><a href="#4-处理结果" class="headerlink" title="4. 处理结果"></a>4. 处理结果</h2><p>获取返回的页面或值:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">String result = EntityUtils.toString(response.getEntity());</div></pre></td></tr></table></figure></p>
<p>获取状态码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">int statusCode = response.getStatusLine().getStatusCode();</div></pre></td></tr></table></figure></p>
<p>获取返回输入流:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">InputStream in = response.getEntity().getContent();</div></pre></td></tr></table></figure></p>
<p>获取header<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Header[] headers = response.getAllHeaders();</div><div class="line">Header[] headers2 = response.getHeaders(&quot;&quot;);</div></pre></td></tr></table></figure></p>
<h2 id="5-关闭相关连接和流"><a href="#5-关闭相关连接和流" class="headerlink" title="5. 关闭相关连接和流"></a>5. 关闭相关连接和流</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">if (response != null) &#123;</div><div class="line">    try &#123;</div><div class="line">        response.close();</div><div class="line">    &#125; catch (IOException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">if (httpClient != null) &#123;</div><div class="line">    try &#123;</div><div class="line">        httpClient.close();</div><div class="line">    &#125; catch (IOException e) &#123;</div><div class="line">        e.printStackTrace();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/03/29/oracle索引失效原因/" itemprop="url">
                  oracle索引失效原因
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-03-29T18:46:20+08:00" content="2017-03-29">
              2017-03-29
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/SQL/" itemprop="url" rel="index">
                    <span itemprop="name">SQL</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/03/29/oracle索引失效原因/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/03/29/oracle索引失效原因/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>隐式转换导致索引失效</li>
<li>对索引列进行运算导致索引失效</li>
<li>使用函数导致索引失效(应创建基于函数的索引)<pre><code>create index index_name on table_name(func_name(field_name))
</code></pre></li>
<li>使用&lt;&gt;、not in、not exists、!=等导致索引失效(B树索引is not null不会走)</li>
<li>使用like且%在前</li>
<li>使用复合索引，且未使用索引第一列</li>
<li>将空变量值直接与比较运算符比较(应使用IS NULL)</li>
<li>CBO分析使用索引花费较大时，如查询小表或返回数据占全表10%以上</li>
<li>CBO[^1]依赖统计信息，如果统计信息不正常，会导致查询时不使用索引或使用错误的索引.(如果表数据发生较大的变化，比如超过20%，可能会导致统计信息没有及时变化)</li>
</ul>
<p>[^1]:CBO:Cost-Based Optimizer:基于代价的优化器(原使用RBO:Rule-Based Optimizer:基于规则的优化器)</p>
<hr>
<h3 id="索引分类"><a href="#索引分类" class="headerlink" title="索引分类"></a>索引分类</h3><h4 id="B树索引-默认索引"><a href="#B树索引-默认索引" class="headerlink" title="B树索引(默认索引)"></a>B树索引(默认索引)</h4><p>B树索引就是一棵二叉树，叶子节点(双向链表)包含索引列和指向表中每个匹配行的ROWID值；所有叶子节点具有相同的深度，因而不管查询条件怎样，查询速度基本相同；能够适应精确查询、模糊查询和比较查询<br>适用场景:列基数大时</p>
<h4 id="位图索引"><a href="#位图索引" class="headerlink" title="位图索引"></a>位图索引</h4><p>创建位图索引时会扫描整张表，并为索引列的每个取值建立一个位图（位图中，对表中的每一行使用一位(bit,0或1)来标识该行是否包含该位图的索引列的取值，如果为1，表示对应的ROWID所在的记录包含该位图索引列值），最后通过位图索引中的映射函数完成位到行的ROWID的转换<br>适用场景:列基数小时(如性别)</p>
<hr>
<h4 id="创建索引注意事项"><a href="#创建索引注意事项" class="headerlink" title="创建索引注意事项"></a>创建索引注意事项</h4><ul>
<li>如果有两个以上的索引，其中一个为唯一性索引，oracle将忽略非唯一性索引</li>
<li>至少包含组合索引的第一列</li>
<li>小表不建索引</li>
<li>基数大的列适合建B树索引，基数小的列适合建位图索引</li>
<li>列中有很多空值，且经常查询此列中的非空数据时应建索引</li>
<li>经常进行连接查询的列应建索引</li>
<li>创建索引时将最常查询的列放到最前面</li>
<li>MYSQL LONG和LONG RAW列不能建索引</li>
<li>限制表中索引数量(索引会占用物理空间;当对表中数据进行增加、删除、修改的时候，索引也要动态维护，降低效率)</li>
<li>表中数据经常更新，而查询较少时不应创建索引</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/06/23/Git常用命令/" itemprop="url">
                  Git常用命令
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-06-23T17:07:04+08:00" content="2016-06-23">
              2016-06-23
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/06/23/Git常用命令/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/06/23/Git常用命令/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><ul>
<li><p>add</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git add &lt;file&gt; -- 将工作文件修改提交到本地暂存区</div><div class="line">git add . -- 将所有修改过的工作文件提交到本地暂存区</div><div class="line">git add -p -- 只添加一个文件的一部分到缓存区</div></pre></td></tr></table></figure>
</li>
<li><p>bisect</p>
</li>
<li><p>blame</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git blame &lt;file&gt; -- 查看指定文件每一行的提交者和提交时间</div></pre></td></tr></table></figure>
</li>
<li><p>branch</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">git branch &lt;NewBranchName&gt; -- 新建分支</div><div class="line">git branch &lt;NewBranchName&gt; -v &lt;LogHash&gt; -- 根据提交的log号新建branch</div><div class="line">git branch -a -- 查看所有分支</div><div class="line">git branch -d &lt;BranchName&gt; -- 删除分支</div><div class="line">git branch -r -- 查看远程分支</div><div class="line">git branch -v -- 查看每个分支最后一个提交对象的信息</div></pre></td></tr></table></figure>
</li>
<li><p>checkout</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git checkout &lt;branchname&gt; -- 切换到分支</div><div class="line">git checkout -b &lt;NewLocalBranch&gt; &lt;OriginBranch&gt; -- 从远程分支导出并切换至新本地分支</div><div class="line">git checkout HEAD~num -- 切换到分支的倒数第二个提交</div><div class="line">git checkout HEAD@&#123;1&#125; -- 回滚到上一次的提交</div><div class="line">git checkout tags/&lt;tag&gt; -- 按标签检出(忽略与标签同名的branch)</div></pre></td></tr></table></figure>
</li>
<li><p>cherry-pick</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git cherry-pick &lt;commitId&gt; -- 将某次提交重新再提交</div></pre></td></tr></table></figure>
</li>
<li><p>clone</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone &lt;url&gt; -- 从远程仓库克隆一份到本地</div></pre></td></tr></table></figure>
</li>
<li><p>commit(-m/-F是必选项,在其它命令中省略)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git commit --amend -- 补提交到上次提交</div><div class="line">git commit -date xxxx.xx.xx -- 修改提交日期到指定日期</div><div class="line">git commit -F &lt;file&gt; -- 从文件中读取说明</div><div class="line">git commit -m &quot;comment&quot; &lt;file&gt; -- 提交文件并添加说明</div></pre></td></tr></table></figure>
</li>
<li><p>config</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git config --global &quot;user.name&quot; [name] -- 查看或设置username</div><div class="line">git config --global &quot;user.email&quot; [email] -- 查看或设置email</div><div class="line">git config --list -- 查看所有git config</div></pre></td></tr></table></figure>
</li>
<li><p>diff</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">git diff -- 查看工作目录里还没有staged且在下次提交时不会被提交的修改</div><div class="line">git diff --cached -- 查看已经staged且下次提交会被提交的修改</div><div class="line">git diff HEAD -- 查看最后一次提交之后工作目录中文件的变更</div><div class="line">git diff HEAD -- &lt;file&gt; -- 查看最后一次提交后某文件的变更</div><div class="line">git diff ...dev -- 查看当前分支和dev分支差异</div><div class="line">git diff master...dev -- 查看master分支和dev分支差异</div></pre></td></tr></table></figure>
</li>
<li><p>fetch</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git fetch &lt;host&gt; -- 获取远程主机的所有分支更新</div><div class="line">git fetch &lt;host&gt; &lt;branch&gt; -- 获取远程主机指定分支的更新</div></pre></td></tr></table></figure>
</li>
<li><p>init</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git init -- 普通初始化,可以在生成的目录下进行git操作</div><div class="line">git init --bare -- 生成裸仓库，在生成目录中只记录git历史提交的版本信息，而不允许用户进行git操作</div></pre></td></tr></table></figure>
</li>
<li><p>log</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git log -- 查看提交的hash</div><div class="line">git log --oneline -- 将一次提交的log显示为1行,即只显示hash和comment</div><div class="line">git log --pretty=oneline -- 将一次提交的log显示为1行,即只显示hash和comment</div><div class="line">git log --reverse -p [fileName] -- 查看某文件或全部文件的提交日志</div></pre></td></tr></table></figure>
</li>
<li><p>merge</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git merge &lt;BranchName&gt; -- 合并分支到当前分支</div><div class="line">git merge &lt;host&gt;/&lt;branch&gt; -- 远程host的branch与本地分支合并</div><div class="line">git merge --squash &lt;BranchName&gt; -- 从分支合并时保存为一次提交</div></pre></td></tr></table></figure>
</li>
<li><p>mv</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git mv &lt;oldname&gt; &lt;newname&gt; -- git重命名</div><div class="line">git mv &lt;files&gt; &lt;folder&gt;/ -- git移动文件到新目录</div></pre></td></tr></table></figure>
</li>
<li><p>pull</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">git pull -- 如果本地当前分支只有一个远程追踪分支，可省略远程主机名与分支名</div><div class="line">git pull &lt;OriginHost&gt; -- 如果本地当前分支与远程分支存在追踪关系，可以省略远程分支名</div><div class="line">git pull &lt;OriginHost&gt; &lt;OriginBranch&gt; -- 取回远程主机的指定分支与本地当前分支合并</div><div class="line">git pull &lt;OriginHost&gt; &lt;OriginBranch&gt;:&lt;LocalBranch&gt; -- 取回远程主机的指定分支与本地的指定分支合并</div></pre></td></tr></table></figure>
</li>
<li><p>push</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">git push &lt;OriginHost&gt; &lt;LocalBranch&gt;:&lt;OriginBranch&gt; -- 提交到远程仓库</div><div class="line">git push &lt;OriginHost&gt; &lt;LocalBranch&gt; -- 提交到远程仓库的同名分支,如果分支不存在则新建</div><div class="line">git push &lt;OriginHost&gt; :&lt;OriginBranch&gt; -- 删除指定的远程分支</div><div class="line">git push &lt;OriginHost&gt; -- 如果本地当前分支与远程分支存在追踪关系,则可省略</div><div class="line">git push -- 如果当前分支只有一个远程追踪分支,可忽略主机名</div><div class="line">git push --all &lt;OriginHost&gt; -- 不管本地分支是否存在对应的远程分支，将本地的所有分支都推送到远程分支</div><div class="line">git push --force &lt;OriginHost&gt; -- 即使远程分支比本地分支新也强制推送</div><div class="line">git push --tags -- push时带上tag,默认push是不带tag的</div></pre></td></tr></table></figure>
</li>
<li><p>rebase（-i:交互式操作)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">git rebase &lt;OriginBranch&gt; -- 将当前分支的每个提交取消掉，并把它们作为patch放到.git/rebash目录中,然后把当前分支更新到最新的远程分支,最后把patch应用到当前分支上</div><div class="line">git rebase &lt;CommitId&gt; -- 将指定commit取消掉，并把它们作为patch放到.git/rebash目录中,然后把当前分支更新到最新的远程分支,最后把patch应用到当前分支上</div><div class="line">git rebase HEAD~2 -- 从当前到倒数第二个，并把它们作为patch放到.git/rebash目录中,然后把当前分支更新到最新的远程分支,最后把patch应用到当前分支上</div><div class="line">git rebase --abort -- 取消rebase,回到rebase前状态</div><div class="line">git rebase --continue -- 当rebash出现冲突时,需要先解决冲突,当冲突解决后可以使用该命令继续rebase</div></pre></td></tr></table></figure>
</li>
<li><p>reflog</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git reflog -- 查看操作历史</div></pre></td></tr></table></figure>
</li>
<li><p>remote</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git remote -- 查看所有远程分支</div><div class="line">git remote -v -- 查看所有远程分支及其URL</div><div class="line">git remote add &lt;OriginHost&gt; &lt;OriginUrl&gt; -- 给当前本地分支添加远程主机</div></pre></td></tr></table></figure>
</li>
<li><p>repack</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git repack -- 压缩</div><div class="line">git repack -d -- 多余文件直接删除</div></pre></td></tr></table></figure>
</li>
<li><p>reset(soft:缓存区和工作都不会改变;mixed,默认,缓存区改变;hard,都改变)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git reset HEAD &lt;file&gt; -- 将已经add的文件移出staging area</div><div class="line">git reset HEAD~2 -- 将一个分支的末端指向倒数第二个提交</div></pre></td></tr></table></figure>
</li>
<li><p>revert </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git revert HEAD~2 -- 以倒数第二个提交作为新提交添加到分支末端</div></pre></td></tr></table></figure>
</li>
<li><p>rm</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git rm &lt;file&gt; -- 从版本库中删除文件 </div><div class="line">git rm --cached &lt;file&gt; -- 将已经add但未提交的文件从缓冲区删除</div></pre></td></tr></table></figure>
</li>
<li><p>squash(合并提交,多用于rebase -i操作中)</p>
</li>
<li><p>stash</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">git stash -- 保存所有文件变更(git status时此变更不会再出现)</div><div class="line">git stash apply --index -- 重新应用被保存的变更</div><div class="line">git stash list -- 查看所有stash文件</div></pre></td></tr></table></figure>
</li>
<li><p>status</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git status -- 查看已提交的，已add未提交的，未add的文件(untracked/changes not staged for commit/changes to be committed)</div></pre></td></tr></table></figure>
</li>
<li><p>submodule</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git submodule add &lt;SubmoduleUrl&gt; -- 添加子项目</div></pre></td></tr></table></figure>
</li>
<li><p>tag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git tag -- 查看当前所有标签</div><div class="line">git tag &lt;tagname&gt; -- 打标签</div></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h3 id="gitignore用法"><a href="#gitignore用法" class="headerlink" title="gitignore用法"></a>gitignore用法</h3><ul>
<li>空行或以#开头的行会被忽略</li>
<li>可以使用标准glob模式匹配（glob模式即shell使用的简化了的正则表达式）<ul>
<li>*匹配0或多个字符</li>
<li>?匹配一个任意字符</li>
<li>[]中使用-分隔两个字符表示匹配这两个字符范围内的字符</li>
<li>[]中多个字符表示匹配多字符中的任意一个字符</li>
</ul>
</li>
<li>匹配模式最后跟/说明要忽略的是目录</li>
<li>要忽略指定模式以外的文件或目录，可以在模式前加!</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/18/对ThreadLocal的理解/" itemprop="url">
                  对ThreadLocal的理解
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-18T17:09:46+08:00" content="2016-03-18">
              2016-03-18
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Thread/" itemprop="url" rel="index">
                    <span itemprop="name">Thread</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/03/18/对ThreadLocal的理解/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/03/18/对ThreadLocal的理解/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h4><ul>
<li><p>创建ThreadLocal变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ThreadLocal&lt;String&gt; threadLocalDemo = new ThreadLocal&lt;&gt;();  // 支持范型</div></pre></td></tr></table></figure>
</li>
<li><p>get/set</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">threadLocalDemo.set(&quot;test&quot;);</div><div class="line">threadLocalDemo.get();</div></pre></td></tr></table></figure>
</li>
<li><p>初始值(为ThreadLocal设置初始值，需要重写initialValue方法)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">ThreadLocal&lt;String&gt; threadLocalDemo = new ThreadLocal&lt;&gt;() &#123;</div><div class="line">    @Override</div><div class="line">    protected String initialValue() &#123;</div><div class="line">        return Thread.currentThread().getName();</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>使用InheritableThreadLocal可以实现多个线程访问ThreadLocal的值</p>
</li>
<li><p>是否会导致内存泄露</p>
<ul>
<li>结论是不会.</li>
<li>ThreadLocal被线程的ThreadLocalMap所持有，也可以看成被线程持有，如果使用线程池，之前的线程在处理完之后出于复用的目的依然存活，表面上看ThreadLocal的值仍然被持有，导致内存泄露.但是ThreadLocalMap在做选择key时并不是直接使用ThreadLocal实例，而是使用ThreadLocalMap实例的弱引用.</li>
</ul>
</li>
<li><p>ThreadLocal对象实例存放位置</p>
<ul>
<li>Java中栈内存属于单个线程，即每个线程都有一个栈内存，其存储的变量只在所属线程中可见，栈内存可被理解成线程的私有内存。而堆内存中的对象对所有线程可见。</li>
<li>ThreadLocal实例虽然也是线程独占的，但其是存放于堆上的，只是使用特殊的技巧使其线程可见了</li>
</ul>
</li>
</ul>
<h4 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h4><ul>
<li><p>ThreadLocal</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">public void testThreadLocal() &#123;</div><div class="line">    Thread t = new Thread() &#123;</div><div class="line">        ThreadLocal&lt;String&gt; threadLocalDemo = new ThreadLocal&lt;&gt;();</div><div class="line">        </div><div class="line">        @Override</div><div class="line">        public void run() &#123;</div><div class="line">            super.run();</div><div class="line">            threadLocalDemo.set(&quot;test&quot;);</div><div class="line">            threadLocalDemo.get();</div><div class="line">        &#125;    </div><div class="line">    &#125;;</div><div class="line">    t.start();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>InheritableThreadLocal</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public void testInheritableThreadLocal() &#123;</div><div class="line">    final ThreadLocal inheritableThreadLocalDemo = new InheritableThreadLocal();</div><div class="line">    inheritableThreadLocalDemo.set(&quot;test&quot;);</div><div class="line">    Thread t = new Thread() &#123;</div><div class="line">        @Override</div><div class="line">        public void run() &#123;</div><div class="line">            super.run();</div><div class="line">            logger.info(&quot;inheritableThreadLocal:&quot; + inheritableThreadLocal.get());</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    t.start();</div></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><ul>
<li>实现单个线程单例及单个线程上下文信息存储，如交易ID等</li>
<li>实现线程安全，非线程安全的对象使用ThreadLocal后会变得线程安全，因为每个线程都会有一个对应的实例</li>
<li>承载一些线程相关的数据，避免在方法中来回传递参数</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/02/28/wait与sleep区别/" itemprop="url">
                  wait与sleep区别
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-02-28T01:04:04+08:00" content="2016-02-28">
              2016-02-28
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/02/28/wait与sleep区别/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/02/28/wait与sleep区别/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>等待时wait会释放锁，sleep则一直持有锁</p>
</li>
<li><p>wait通常被用于线程间交互，而sleep通常被用于暂停执行</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/30/Log4j配置/" itemprop="url">
                  Log4j配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-30T20:57:48+08:00" content="2016-01-30">
              2016-01-30
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Apache/" itemprop="url" rel="index">
                    <span itemprop="name">Apache</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/01/30/Log4j配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/01/30/Log4j配置/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Log4j 的配置文件用来设置记录器的<strong>级别</strong>、<strong>输出目的地</strong>和<strong>布局</strong>，可以是 log4j.properties 或 log4j.xml。以下讲解以 log4j.properties 的配置方式进行。</p>
<h2 id="配置文件的基本格式"><a href="#配置文件的基本格式" class="headerlink" title="配置文件的基本格式"></a>配置文件的基本格式</h2><p>基本格式如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">#配置根 Logger</div><div class="line">log4j.rootLogger = [ level ], appenderName1, appenderName2, ……</div><div class="line">#配置日志信息输出目的地 (Appender)</div><div class="line">log4j.appender.appenderName = fully.qualified.name.of.appender.class </div><div class="line">log4j.appender.appenderName.option1 = value1 </div><div class="line">……</div><div class="line">log4j.appender.appenderName.optionN = valueN </div><div class="line">#配置日志信息的格式 (Layout)</div><div class="line">log4j.appender.appenderName.layout = fully.qualified.name.of.layout.class </div><div class="line">log4j.appender.appenderName.layout.option1 = value1 </div><div class="line">……</div><div class="line">log4j.appender.appenderName.layout.optionN = valueN</div></pre></td></tr></table></figure></p>
<h2 id="Level"><a href="#Level" class="headerlink" title="Level"></a>Level</h2><p>Level 是日志输出级别，共有5级：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>级别</th>
</tr>
</thead>
<tbody>
<tr>
<td>FATAL</td>
<td>0</td>
</tr>
<tr>
<td>ERROR</td>
<td>3</td>
</tr>
<tr>
<td>WARN</td>
<td>4</td>
</tr>
<tr>
<td>INFO</td>
<td>6</td>
</tr>
<tr>
<td>DEBUG</td>
<td>7</td>
</tr>
</tbody>
</table>
<h2 id="Appender"><a href="#Appender" class="headerlink" title="Appender"></a>Appender</h2><p>Appender 为日志输出目的地，Log4j 提供的 appender 有以下几种：</p>
<ul>
<li>org.apache.log4j.ConsoleAppender（控制台）</li>
<li>org.apache.log4j.FileAppender（文件）</li>
<li>org.apache.log4j.DailyRollingFileAppender（每天产生一个日志文件）</li>
<li>org.apache.log4j.RollingFileAppender（文件大小到达指定尺寸的时候产生一个新的文件）</li>
<li>org.apache.log4j.WriterAppender（将日志信息以流格式发送到任意指定的地方）<h3 id="ConsoleAppender-可配置项"><a href="#ConsoleAppender-可配置项" class="headerlink" title="ConsoleAppender 可配置项"></a>ConsoleAppender 可配置项</h3></li>
</ul>
<table>
<thead>
<tr>
<th>项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>Threshold=DEBUG</td>
<td>指定日志消息的输出最低层次</td>
</tr>
<tr>
<td>ImmediateFlush=true</td>
<td>默认值是 true，意味着所有的消息都会被立即输出</td>
</tr>
<tr>
<td>Target=System.err</td>
<td>默认情况下是 System.out，指定输出控制台</td>
</tr>
</tbody>
</table>
<h3 id="FileAppender-可配置项"><a href="#FileAppender-可配置项" class="headerlink" title="FileAppender 可配置项"></a>FileAppender 可配置项</h3><table>
<thead>
<tr>
<th>项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>Threshold=DEBUF</td>
<td>指定日志消息的输出最低层次</td>
</tr>
<tr>
<td>ImmediateFlush=true</td>
<td>默认值是 true，意味着所有的消息都会被立即输出</td>
</tr>
<tr>
<td>File=mylog.txt</td>
<td>指定消息输出到 mylog.txt 文件</td>
</tr>
<tr>
<td>Append=false</td>
<td>默认值是true,即将消息增加到指定文件中，false指将消息覆盖指定的文件内容</td>
</tr>
</tbody>
</table>
<h3 id="RollingFileAppender-可配置项"><a href="#RollingFileAppender-可配置项" class="headerlink" title="RollingFileAppender 可配置项"></a>RollingFileAppender 可配置项</h3><table>
<thead>
<tr>
<th>项</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>Threshold=DEBUG</td>
<td>指定日志消息的输出最低层次。</td>
</tr>
<tr>
<td>ImmediateFlush=true</td>
<td>默认值是true,意味着所有的消息都会被立即输出。</td>
</tr>
<tr>
<td>File=mylog.txt</td>
<td>指定消息输出到mylog.txt文件。</td>
</tr>
<tr>
<td>Append=false</td>
<td>默认值是true即将消息增加到指定文件中，false指将消息覆盖指定的文件内容。</td>
</tr>
<tr>
<td>MaxFileSize=100KB</td>
<td>后缀可以是KB, MB 或者是 GB.</td>
<td>在日志文件到达该大小时，将会自动滚动，即将原来的内容移到mylog.log.1文件。</td>
</tr>
<tr>
<td>MaxBackupIndex=2</td>
<td>指定可以产生的滚动文件的最大数。</td>
</tr>
</tbody>
</table>
<h2 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h2><p>Layout 为日志输出格式，Log4j 提供的 layout 有以下几种：</p>
<ul>
<li>org.apache.log4j.HTMLLayout（以HTML表格形式布局），</li>
<li>org.apache.log4j.PatternLayout（可以灵活地指定布局模式），</li>
<li>org.apache.log4j.SimpleLayout（包含日志信息的级别和信息字符串），</li>
<li><p>org.apache.log4j.TTCCLayout（包含日志产生的时间、线程、类别等等信息）</p>
<h3 id="Layout-示例"><a href="#Layout-示例" class="headerlink" title="Layout 示例"></a>Layout 示例</h3><p>  log4j.appender.A1.layout.ConversionPattern=%-4r %-5p %d{yyyy-MM-dd HH:mm:ssS} %c %m%n</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>符号</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>-</td>
<td>信息输出时左对齐</td>
</tr>
<tr>
<td>%p</td>
<td>输出日志信息优先级，即DEBUG，INFO，WARN，ERROR，FATAL</td>
</tr>
<tr>
<td>%d</td>
<td>输出日志时间点的日期或时间，默认格式为ISO8601，也可以在其后指定格式，比如：%d{yyy MMM dd HH:mm:ss,SSS}，输出类似：2002年10月18日 22:10:28,921</td>
</tr>
<tr>
<td>%r</td>
<td>输出自应用启动到输出该log信息耗费的毫秒数</td>
</tr>
<tr>
<td>%c</td>
<td>输出日志信息所属的类，通常就是所在类的全名</td>
</tr>
<tr>
<td>%t</td>
<td>输出产生该日志事件的线程名</td>
</tr>
<tr>
<td>%l</td>
<td>输出日志事件的发生位置，相当于%C.%M(%F:%L)的组合,包括类目名、发生的线程，以及在代码中的行数。举例：Testlog4.main (TestLog4.java:10)</td>
</tr>
<tr>
<td>%x</td>
<td>输出和当前线程相关联的NDC(嵌套诊断环境),尤其用到像java servlets这样的多客户多线程的应用中。</td>
</tr>
<tr>
<td>%%</td>
<td>输出一个”%”字符</td>
</tr>
<tr>
<td>%F</td>
<td>输出日志消息产生时所在的文件名称</td>
</tr>
<tr>
<td>%L</td>
<td>输出代码中的行号</td>
</tr>
<tr>
<td>%m</td>
<td>输出代码中指定的消息,产生的日志具体信息</td>
</tr>
<tr>
<td>%n</td>
<td>输出一个回车换行符，Windows平台为”\r\n”，Unix平台为”\n”</td>
</tr>
</tbody>
</table>
<h3 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h3><p>可以在%与模式字符之间加上修饰符来控制其最小宽度、最大宽度和文本的对齐方式，如：</p>
<table>
<thead>
<tr>
<th>示例</th>
<th>表示</th>
</tr>
</thead>
<tbody>
<tr>
<td>%20c</td>
<td>指定输出category的名称，最小的宽度是20，如果category的名称小于20的话，默认的情况下右对齐。</td>
</tr>
<tr>
<td>%-20c</td>
<td>指定输出category的名称，最小的宽度是20，如果category的名称小于20的话，”-“号指定左对齐。</td>
</tr>
<tr>
<td>%.30c</td>
<td>指定输出category的名称，最大的宽度是30，如果category的名称大于30的话，就会将左边多出的字</td>
<td>符截掉，但小于30的话也不会有空格。</td>
</tr>
<tr>
<td>%20.30c</td>
<td>如果category的名称小于20就补空格，并且右对齐，如果其名称长于30字符，就从左边较远输出的字符截掉。</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/01/26/Mybatis批量操作/" itemprop="url">
                  Mybatis批量操作
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-01-26T02:44:44+08:00" content="2016-01-26">
              2016-01-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">Mybatis</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/01/26/Mybatis批量操作/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/01/26/Mybatis批量操作/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>批量插入数据</li>
</ol>
<p>eg:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;insert id=&quot;&quot; parameterType=&quot;&quot; resultType=&quot;&quot;&gt;</div><div class="line"></div><div class="line">insert into table_name values</div><div class="line"></div><div class="line">&lt;foreach collection=&quot;list&quot; item=&quot;itemName&quot; index=&quot;index&quot; separator=&quot;,&quot;&gt;</div><div class="line"></div><div class="line">(#&#123;itemName.xxx&#125;,#&#123;itemName&#125;.xxx,...)</div><div class="line"></div><div class="line">&lt;/foreach&gt;</div><div class="line"></div><div class="line">&lt;/insert&gt;</div></pre></td></tr></table></figure></p>
<ol>
<li>批量更新数据</li>
</ol>
<p>eg:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;update id=&quot;&quot; parameterType=&quot;&quot; resultType=&quot;&quot;&gt;</div><div class="line"></div><div class="line">update table_name </div><div class="line"></div><div class="line">&lt;trim prefix=&quot; log =case&quot; suffix=&quot;end,&quot;&gt;</div><div class="line"></div><div class="line">&lt;foreach collection=&quot;list&quot; item=&quot;itemName&quot; index=&quot;index&quot; separator=&quot;,&quot;&gt;</div><div class="line"></div><div class="line">&lt;if test=&quot;itemName.xxx!=null&quot;&gt;</div><div class="line"></div><div class="line">when id=#&#123;itemName.id&#125; then #&#123;itemName.xxx&#125;</div><div class="line"></div><div class="line">&lt;/if&gt;</div><div class="line"></div><div class="line">&lt;/foreach&gt;</div><div class="line"></div><div class="line">&lt;/trim&gt;</div><div class="line"></div><div class="line">&lt;/upate&gt;</div></pre></td></tr></table></figure></p>
<ol>
<li>批量删除数据</li>
</ol>
<p>eg:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;delete id=&quot;&quot; parameterType=&quot;&quot;&gt;</div><div class="line"></div><div class="line">delete from table_name where id in </div><div class="line"></div><div class="line">&lt;foreach collection=&quot;list&quot; item=&quot;itemName&quot; separator=&quot;,&quot; index=&quot;index&quot;&gt;</div><div class="line"></div><div class="line">(#&#123;itemName.xxx&#125;)</div><div class="line"></div><div class="line">&lt;/foreach&gt;</div><div class="line"></div><div class="line">&lt;/delete&gt;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/27/本地代码与托管代码/" itemprop="url">
                  本地代码与托管代码
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-27T11:48:42+08:00" content="2015-11-27">
              2015-11-27
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Other/" itemprop="url" rel="index">
                    <span itemprop="name">Other</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/11/27/本地代码与托管代码/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/27/本地代码与托管代码/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本地代码与CPU直接相关，由于不同的硬件结构和操作系统，不同的CPU所能执行的本地代码是不同的。也叫本机代码或native代码。C、C++写的代码即为本地代码。<br>Java与C#则采用了虚拟机的机制，屏蔽了底层硬件和操作系统的不同，写的代码经编译后生成了一种中间语言代码，如java的class字节码。这种中间语言代码不能被CPU直接执行，由虚拟机负责解释，并将其转换为本地代码。这种中间语言代码即为托管代码。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2015/11/13/Mybatis学习笔记/" itemprop="url">
                  Mybatis学习笔记
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2015-11-13T04:49:34+08:00" content="2015-11-13">
              2015-11-13
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">Mybatis</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2015/11/13/Mybatis学习笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2015/11/13/Mybatis学习笔记/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="SqlSessionFactoryBuilder"><a href="#SqlSessionFactoryBuilder" class="headerlink" title="SqlSessionFactoryBuilder"></a>SqlSessionFactoryBuilder</h1><p>这个类可以被实例化、使用和丢弃，一旦创建了SqlSessionFactory，就不再需要它了</p>
<h1 id="SqlSessionFactory"><a href="#SqlSessionFactory" class="headerlink" title="SqlSessionFactory"></a>SqlSessionFactory</h1><ul>
<li>SqlSessionFactory可以通过sqlSessionFactoryBuilder获得</li>
<li>SqlSessionFactory一旦被创建就应该在应用的运行期间一直存在，没有理由对它进行清除或重建.最佳范围是应用范围，可以使用单例模式或静态单例模式<h1 id="SqlSession"><a href="#SqlSession" class="headerlink" title="SqlSession"></a>SqlSession</h1></li>
<li>SqlSession的实例不是线程安全的，因此是不能共享的，所以它的最佳范围是方法或请求.绝对不能将SqlSession实例的引用放在一个类的静态域，甚至一个类的实例变量也不行。也绝不能将SqlSession实例的引用放在任何类型的管理范围中，比如Servlet架构的HttpSession.每次收到Http请求就打开一个sqlSession，返回响应就关闭它.<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">try &#123;</div><div class="line">    // do something</div><div class="line">&#125; finally &#123;</div><div class="line">    sqlSession.close();</div><div class="line">&#125;</div></pre></td></tr></table></figure></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="delavior" />
          <p class="site-author-name" itemprop="name">delavior</p>
          <p class="site-description motion-element" itemprop="description">Write Something when I'm on the way to be a real programmer.</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">44</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">35</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/delavior" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/delavior" target="_blank" title="Zhihu">
                  
                    <i class="fa fa-fw fa-zhihu"></i>
                  
                  Zhihu
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://v2ex.com/member/delavior" target="_blank" title="V2EX">
                  
                    <i class="fa fa-fw fa-v2ex"></i>
                  
                  V2EX
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.douban.com/people/delavior" target="_blank" title="Douban">
                  
                    <i class="fa fa-fw fa-douban"></i>
                  
                  Douban
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  Sun Jun 29 2014 08:00:00 GMT+0800 (中国标准时间) - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">delavior</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'delavior';
      var disqus_identifier = 'index.html';
      var disqus_title = "";
      var disqus_url = '';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
    </script>
  




  
  

  

  

  

  


</body>
</html>
